import{_ as b,t as p,j as k,c as f,d as s,k as _,l as w,i as c,e as i,a as n,w as d,V as u,n as y,r as x,o as v}from"./index-DokaCfUL.js";import{g as m}from"./index-ZORhgBxb.js";const z={name:"TestVue",data(){return{template:{},viewersRatio:.5,layoutName:null,layout:null,playlistName:null,playlist:null,loading:!1,currentData:null,currentDefinition:null,selectedItem:null,previewPaneWidth:0,templateServer:""}},methods:{GetTemplateServerUrlBase(){var e="";if(this.templateServer==null)return"";switch(this.templateServer){case"online":e="https://chronorace.blob.core.windows.net/webresources/cgtemplates/index.html#/";break;case"local":e="https://localhost:8080/webresources/cgtemplates/index.html#/";break;default:this.templateServer.startsWith("http")?e=this.templateServer:e="https://"+this.templateServer+"/webresources/cgtemplates/index.html#/";break}return console.log("toRet=",e),e},GetRouteUrl(){var e=this.$router.resolve({name:"cgtest"});return e.href},LoadPlayList(){this.loading=!1,console.log("load playlist ",this.layoutName,this.playlistName),p.getPlayList(this.layoutName,this.playlistName).then(e=>{this.playlist=e}),p.get(this.layoutName).then(e=>{this.layout=e,this.loading=!1,this.resizeViewers()})},GetQueryParameters(){return this.$route.query},setViewersRatio(e){this.viewersRatio=e,setTimeout(()=>{this.resizeViewers()},0)},processCommand(e){console.log("process command",e),e.item,setTimeout(()=>{},0)},ObjectChanged(e,t){console.log("change occured",t),this.selectedItem!=null&&(this.selectedItem.data=t)},OpenObjectEditor(){var e=this.$refs.objEditor;console.log("ok? ",e),e.Edit(this.obj,this.definition,"Hello").then(t=>{console.log("object editor reply: ",t),t.key=="OK"&&(this.obj=t.data)})},GetTemplate(){p.get("WBD").then(e=>{this.template=e,console.log("resolution of template: ",this.template)})},setBackground(e,t){m.set(this.$refs[e],{"background-color":t})},setViewerSize(e){console.log("set viewer size: "),m.set(this.$refs.viewer,{width:e,height:e*9/16}),m.set(this.$refs.frame,{scale:e/1920})},setViewerSizeTest(e){console.log("set viewer size: "),m.set(this.$refs.viewer,{width:e,height:e*9/16}),m.set(this.$refs.frame,{scale:e/1920})},getElementWidth(e){var t=getComputedStyle(e),o=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),h=parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth);return e.offsetWidth-o-h},resizeViewers(){var e=this.$el.querySelectorAll(".viewer");console.log("resize viewers",e.length),e.forEach(t=>{if(this.layout){var o=this.getElementWidth(t.parentNode),h=this.layout.resolution[0]/this.layout.resolution[1],r=o/this.layout.resolution[0];console.log("viewer ",o,this.layout.resolution[0],h);var l=t.querySelectorAll("iframe");console.log("IFrame ",l,o,o*9/16),m.set(t,{width:o,height:o/h}),m.set(l,{scale:r})}})}},mounted:function(){this.templateServer=this.$route.query.ts,console.log("playlist mounted: ",this.$route.query),this.$route.query.env&&k.setEnv(this.$route.query.env),this.layoutName=this.$route.params.layout,this.playlistName=this.$route.params.playlist,this.LoadPlayList(),this.resizeObserver=new ResizeObserver(t=>{var o=t[0];m.set(this.$refs.previewPane,{width:o.contentRect.width});for(let h of t)console.log(`Size changed! New size: ${h.contentRect.width}px by ${h.contentRect.height}px`),this.previewPaneWidth=h.contentRect.width,this.resizeViewers()});var e=this.$refs.previewPaneParent;e&&this.resizeObserver.observe(e)},beforeUnmount(){console.log("stop resize observer"),this.resizeObserver.unobserve()},created:function(){}},C={style:{display:"flex",width:"100%"}},S={style:{"max-width":"400px","min-width":"400px","xbackground-color":"aqua","padding-left":"8px","padding-right":"8px"}},R={key:1},P={ref:"previewPaneParent",style:{"xbackground-color":"pink",flex:"1"}},B={key:0,style:{"background-color":"#ddd"}},V=s("br",null,null,-1),N=s("br",null,null,-1),E={ref:"previewPane",style:{position:"fixed","xbackground-color":"pink",width:"100%"}},W=s("br",null,null,-1),$=s("br",null,null,-1),L={style:{display:"flex",width:"100%"}},T=s("h3",null,"Preview",-1),j=s("br",null,null,-1),q={class:"viewer",ref:"viewer1"},O=["src"],G=s("h3",null,"Main",-1),I=s("br",null,null,-1),D={class:"viewer",ref:"viewer2"},F=["src"],U=s("pre",null,"        ",-1);function A(e,t,o,h,r,l){const g=x("PlaylistItemRoot");return v(),f("div",null,[s("div",C,[s("div",S,[r.playlist?(v(),_(g,{key:0,onCommand:l.processCommand,layout:r.layout,item:r.playlist},null,8,["onCommand","layout","item"])):w("",!0),r.playlist?(v(),f("span",R,"MAX ID: "+c(r.playlist.maxid),1)):w("",!0)]),s("div",P,[r.layout?(v(),f("div",B,[i(" Resolution: "),s("b",null,c(r.layout.resolution[0])+" x "+c(r.layout.resolution[1]),1),V,i(" Layout: "),s("b",null,c(r.layout.layout),1)])):w("",!0),N,s("div",E,[i(" Viewer width ("+c(r.previewPaneWidth)+"): ",1),n(u,{size:"small",onClick:t[0]||(t[0]=a=>l.setViewersRatio(.5))},{default:d(()=>[i("50/50")]),_:1}),n(u,{size:"small",onClick:t[1]||(t[1]=a=>l.setViewersRatio(.3))},{default:d(()=>[i("30/70")]),_:1}),W,$,s("div",L,[s("div",{style:y([{width:this.viewersRatio*100+"%"},{padding:"5px",overflow:"hidden"}])},[T,n(u,{size:"small",onClick:t[2]||(t[2]=a=>l.setBackground("viewer1","#000000"))},{default:d(()=>[i("black")]),_:1}),n(u,{size:"small",onClick:t[3]||(t[3]=a=>l.setBackground("viewer1","#ffffff"))},{default:d(()=>[i("white")]),_:1}),n(u,{size:"small",onClick:t[4]||(t[4]=a=>l.setBackground("viewer1","#ff0000"))},{default:d(()=>[i("red")]),_:1}),n(u,{size:"small",onClick:t[5]||(t[5]=a=>l.setBackground("viewer1","#aaaaaa"))},{default:d(()=>[i("grey")]),_:1}),s("button",{class:"warning",onClick:t[6]||(t[6]=a=>e.cls())},"clear"),j,s("div",q,[s("iframe",{class:"scaled-frame","scrolling:":"no",src:"https://www.chronorace.be"},null,8,O)],512),s("span",null,c(l.GetTemplateServerUrlBase()),1)],4),s("div",{style:y([{width:(1-this.viewersRatio)*100+"%"},{padding:"5px",overflow:"hidden"}])},[G,n(u,{size:"small",onClick:t[7]||(t[7]=a=>l.setBackground("viewer2","#000000"))},{default:d(()=>[i("black")]),_:1}),n(u,{size:"small",onClick:t[8]||(t[8]=a=>l.setBackground("viewer2","#ffffff"))},{default:d(()=>[i("white")]),_:1}),n(u,{size:"small",onClick:t[9]||(t[9]=a=>l.setBackground("viewer2","#ff0000"))},{default:d(()=>[i("red")]),_:1}),n(u,{size:"small",onClick:t[10]||(t[10]=a=>l.setBackground("viewer2","#aaaaaa"))},{default:d(()=>[i("grey")]),_:1}),s("button",{class:"warning",onClick:t[11]||(t[11]=a=>e.cls())},"clear"),I,s("div",D,[s("iframe",{style:{position:"relative",display:"relative"},class:"scaled-frame","scrolling:":"no",src:"https://www.chronorace.be"},null,8,F)],512),s("span",null,c(l.GetTemplateServerUrlBase()),1)],4)]),s("pre",null,[i(`
          `+c(l.GetQueryParameters())+`
          `+c(r.playlist)+`

          `,1),U,i(`

          `)])],512)],512)])])}const Q=b(z,[["render",A]]);export{Q as default};
